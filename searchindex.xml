<?xml version="1.0" encoding="utf-8" standalone="yes"?><search><entry><title>Markdownè¯­æ³•æ‰‹å†Œ</title><url>/post/markdown-syntax/</url><categories><category>themes</category><category>syntax</category></categories><tags><tag>markdown</tag><tag>css</tag><tag>html</tag></tags><content type="html"> æœ¬æ–‡æä¾›äº†ä¸€ä¸ªå¯ä»¥åœ¨ Hugo å†…å®¹æ–‡ä»¶ä¸­ä½¿ç”¨çš„åŸºæœ¬Markdownè¯­æ³•ç¤ºä¾‹ï¼Œè¿˜å±•ç¤ºäº†åŸºæœ¬ HTML å…ƒç´ åœ¨ Hugo ä¸»é¢˜ä¸­æ˜¯å¦ä½¿ç”¨ CSS è£…é¥°ã€‚
æ ‡é¢˜ ä¸‹é¢çš„ HTML ä»£ç &lt;h1>â€”&lt;h6> å…ƒç´ è¡¨ç¤ºå…­ä¸ªçº§åˆ«çš„èŠ‚æ ‡é¢˜ã€‚ &lt;h1>æ˜¯æœ€é«˜çš„èŠ‚çº§åˆ«ï¼Œ&lt;h6>æ˜¯æœ€ä½çš„èŠ‚çº§åˆ«ã€‚
H1 H2 H3 H4 H5 H6 æ®µè½ ç”Ÿæ´»æ˜¯ä»€ä¹ˆï¼Ÿç”Ÿæ´»æ˜¯æŸ´ç±³æ²¹ç›çš„å¹³æ·¡ï¼›æ˜¯è¡Œè‰²åŒ†åŒ†æ—©å‡ºæ™šå½’çš„å¥”æ³¢ï¼›ç”Ÿæ´»æ˜¯é”™çš„æ—¶é—´é‡åˆ°å¯¹çš„äººçš„é—æ†¾ï¼›æ˜¯çˆ±çš„ä»˜å‡ºä¸å›æŠ¥ï¼›ç”Ÿæ´»æ˜¯çœ‹ä¸åŒçš„é£æ™¯ï¼Œé‡åˆ°ä¸åŒçš„äººï¼›æ˜¯è¡Œè‡³æ°´ç©·å°½ï¼Œåçœ‹äº‘èµ·æ—¶çš„å³°å›è·¯è½¬ï¼›ç”Ÿæ´»æ˜¯çµé­‚ç»å†ä¼¤ç—›åçš„å¾®ç¬‘æ€’æ”¾ï¼›æ˜¯æŒ«æŠ˜åå·è¢«æ™¾æ™’åçš„åšå¼ºï¼›ç”Ÿæ´»æ˜¯é…¸ç”œè‹¦è¾£è¢«å²æœˆæ²‰æ·€åçš„é¦¨é¦™ï¼›æ˜¯ç»å†é£éœœé›ªé›¨æ´—ç¤¼åçš„æ‡‚å¾—ï¼›ç”Ÿæ´»æ˜¯èµ°éåƒå±±ä¸‡æ°´åï¼Œå›çœ¸ä¸€ç¬‘çš„æ´’è„±ã€‚
æœ‰äº›äº‹ï¼ŒçŒä¸åŠé˜²ï¼Œä¸ç®¡ä½ åœ¨ä¸åœ¨ä¹ï¼›æœ‰äº›äººï¼Œå¹¶éæ‰€æƒ³ï¼Œä¸ç®¡ä½ æ˜ä¸æ˜ç™½ï¼›æœ‰äº›è·¯ï¼Œå¿…é¡»å¾—èµ°ï¼Œä¸ç®¡ä½ æ„¿ä¸æ„¿æ„ã€‚ä¸æ€•äº‹ï¼Œä¸æƒ¹äº‹ï¼Œä¸é¿äº‹ï¼Œåšå¥½è‡ªå·±ï¼Œç”¨çœŸå¿ƒé¢å¯¹ä¸€åˆ‡ï¼›å°‘åŸ‹æ€¨ï¼Œå°‘æŒ‡è´£ï¼Œå°‘å‘ç«ï¼Œå­¦ä¼šæ²‰é™ï¼Œç”¨å¾®ç¬‘è€ƒé‡ä¸€åˆ‡ï¼›å¤šä½“å¯Ÿï¼Œå¤šåŒ…å®¹ï¼Œå¤šæ€ç´¢ï¼Œå°½å¿ƒå°½åŠ›ï¼Œè™½ç¼ºæ†¾ä½†æ— æ‚”ã€‚åƒè’²å…¬è‹±ä¸€æ ·ç¾ä¸½ï¼Œè™½è½»ç›ˆï¼Œä½†å¹¶ä¸å‘å¾®ï¼Œå®ƒæœ‰è‡ªå·±çš„ç”Ÿå‘½ï¼Œä¹Ÿæœ‰è‡ªå·±çš„ä¸–ç•Œï¼
å¼•ç”¨ blockquote å…ƒç´ è¡¨ç¤ºä»å¦ä¸€ä¸ªæ¥æºå¼•ç”¨çš„å†…å®¹ï¼Œå¯é€‰çš„å¼•ç”¨å¿…é¡»åœ¨ footer æˆ– citeå…ƒç´ å†…ï¼Œä¹Ÿå¯é€‰çš„å†…åµŒæ›´æ”¹ï¼Œå¦‚æ³¨é‡Šå’Œç¼©å†™ã€‚
å¼•ç”¨æ²¡æœ‰å½’å± è¯»æ‡‚è‡ªæˆ‘ï¼Œå¸¦ç€ç®€å•çš„å¿ƒæƒ…ï¼Œçœ‹å¤æ‚çš„äººç”Ÿï¼Œèµ°åå·çš„è·¯ï¼
æ³¨æ„ï¼š å¯ä»¥åœ¨å—å¼•ç”¨ä¸­ä½¿ç”¨ Markdown è¯­æ³•ã€‚
å¸¦å½’å±çš„å¼•ç”¨ ä¸è¦é€šè¿‡åˆ†äº«è®°å¿†æ¥äº¤æµï¼Œé€šè¿‡äº¤æµæ¥åˆ†äº«è®°å¿†ã€‚
â€” ç½—å¸ƒÂ·æ´¾å…‹1
è¡¨æ ¼ è¡¨ä¸æ˜¯Markdownæ ¸å¿ƒè§„èŒƒçš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯Hugoæ”¯æŒå¼€ç®±å³ç”¨ã€‚
Name Age Bob 27 Alice 23 è¡¨æ ¼å†…ä½¿ç”¨Markdownè¯­æ³• Italics Bold Code italics bold code å›¾åƒ ![å›¾åƒæè¿°](å›¾åƒåœ°å€) ç¤ºä¾‹ å¸¸è§„ç”¨æ³• SVGå›¾åƒ Google Chrome
Firefox Browser
å°å›¾æ ‡ ç‚¹å‡»å›¾åƒå¯ä»¥æ‰“å¼€å›¾åƒæµè§ˆå™¨ï¼Œå¿«è¯•è¯•å§ã€‚
ä»£ç å— å¸¦æœ‰å¼•å·çš„ä»£ç å— &lt;!doctype html> &lt;html lang="en"> &lt;head> &lt;meta charset="utf-8"> &lt;title>Example HTML5 Document&lt;/title> &lt;/head> &lt;body> &lt;p>Test&lt;/p> &lt;/body> &lt;/html> ç”¨å››ä¸ªç©ºæ ¼ç¼©è¿›çš„ä»£ç å— &lt;!doctype html> &lt;html lang="en"> &lt;head> &lt;meta charset="utf-8"> &lt;title>Example HTML5 Document&lt;/title> &lt;/head> &lt;body> &lt;p>Test&lt;/p> &lt;/body> &lt;/html> ä»£ç å—å¼•ç”¨Hugoçš„å†…éƒ¨é«˜äº®çŸ­ä»£ç  &lt;!doctype html> &lt;html lang="en"> &lt;head> &lt;meta charset="utf-8"> &lt;title>Example HTML5 Document&lt;/title> &lt;/head> &lt;body> &lt;p>Test&lt;/p> &lt;/body> &lt;/html> åˆ—è¡¨ç±»å‹ æœ‰åºåˆ—è¡¨ First item Second item Third item æ— åºåˆ—è¡¨ List item Another item And another item åµŒå¥—åˆ—è¡¨ Fruit Apple Orange Banana Dairy Milk Cheese å…¶ä»–å…ƒç´  â€” abbr, sub, sup, kbd, mark GIF æ˜¯ä½å›¾å›¾åƒæ ¼å¼ã€‚
H2O
Xn + Yn = Zn
æŒ‰ CTRL+ALT+Delete ç»„åˆé”®ç»“æŸä¼šè¯ã€‚
å¤§å¤šæ•°è¾èˆåœ¨å¤œé—´æ´»åŠ¨ï¼Œæ•é£Ÿæ˜†è™«ã€è •è™«å’Œå…¶ä»–å°åŠ¨ç‰©ã€‚
ä»¥ä¸Šå¼•æ–‡æ‘˜è‡ªRob Pikeåœ¨2015å¹´11æœˆ18æ—¥ Gopherfest ä¸Šçš„æ¼”è®² ã€‚&#160;&#8617;&#xfe0e;</content></entry><entry><title>Rich Content</title><url>/post/rich-content/</url><categories/><tags><tag>shortcodes</tag><tag>privacy</tag></tags><content type="html"> Hugo ships with several Built-in Shortcodes for rich content, along with a Privacy Config and a set of Simple Shortcodes that enable static and no-JS versions of various social media embeds.
YouTube Privacy Enhanced Shortcode {{/&lt; youtube ZJthWmvUzzc >/}}
Twitter Simple Shortcode {{/&lt; twitter_simple 1085870671291310081 >/}}
Vimeo Simple Shortcode {{/&lt; vimeo_simple 48912912 >/}}
Bilibili Shortcode</content></entry><entry><title>å›¾åƒå ä½ç¬¦æ˜¾ç¤º</title><url>/post/placeholder-text/</url><categories/><tags><tag>markdown</tag><tag>text</tag></tags><content type="html"> èŒƒå¾·æ ¼æ‹‰å¤«åŸç†ï¼ˆVan de Graaf Canonï¼‰é‡æ„äº†æ›¾ç»ç”¨äºä¹¦ç±è®¾è®¡ä¸­å°†é¡µé¢åˆ’åˆ†ä¸ºèˆ’é€‚æ¯”ä¾‹çš„æ–¹æ³•ã€‚è¿™ä¸€åŸç†ä¹Ÿè¢«ç§°ä¸ºâ€œç§˜å¯†åŸç†â€ï¼Œç”¨äºè®¸å¤šä¸­ä¸–çºªçš„æ‰‹ç¨¿å’Œå¤æ¿ä¹¦ä¸­ã€‚åœ¨èŒƒå¾·æ ¼æ‹‰å¤«åŸç†ä¸­ï¼Œæ–‡æœ¬åŒºåŸŸå’Œé¡µé¢çš„é•¿æ¬¾å…·æœ‰ç›¸åŒçš„æ¯”ä¾‹ï¼Œå¹¶ä¸”æ–‡æœ¬åŒºåŸŸçš„é«˜åº¦ç­‰äºé¡µé¢å®½åº¦ï¼Œé€šè¿‡åˆ’åˆ†é¡µé¢å¾—åˆ°ä¹åˆ†ä¹‹ä¸€çš„è®¢å£è¾¹è·å’Œä¹åˆ†ä¹‹äºŒçš„åˆ‡å£è¾¹è·ï¼Œä»¥åŠä¸é¡µé¢é•¿å®½ç›¸åŒçš„æ¯”ä¾‹çš„æ–‡æœ¬åŒºåŸŸã€‚
Vagus ç¤ºä¾‹ The Van de Graaf Canon æ€»ç»“ å½“ç„¶è®¾è®¡ä¸­çš„é»„é‡‘æ¯”ä¾‹æ˜¯ä¸ºäººæ‰€ç†ŸçŸ¥çš„ï¼Œé»„é‡‘åˆ†å‰²çš„å…¬å¼ä¸ºa:b=b:(a+b)ã€‚è¿™æ˜¯æŒ‡è¾ƒå°çš„ä¸¤ä¸ªçŸ©å½¢ä¸è¾ƒå¤§çš„ä¸¤ä¸ªçŸ©å½¢ä»¥ç›¸åŒçš„ç»„åˆæ–¹å¼ç›¸å…³è”ã€‚é»„é‡‘åˆ†å‰²æ¯”ä¾‹ä¸º1:1.618ã€‚</content></entry><entry><title>æ•°æ®å…¬å¼è®¾ç½®æ˜¾ç¤º</title><url>/post/math-typesetting/</url><categories/><tags/><content type="html"> Hugo é¡¹ç›®ä¸­çš„æ•°å­¦è¡¨ç¤ºæ³•å¯ä»¥é€šè¿‡ä½¿ç”¨ç¬¬ä¸‰æ–¹ JavaScript åº“æ¥å®ç°ã€‚
åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ MathJax åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ /content/en[zh-CN]/math.md
å¯ä»¥å…¨å±€å¯ç”¨MathJaxï¼Œè¯·åœ¨é¡¹ç›®é…ç½®ä¸­å°†å‚æ•°mathè®¾ç½®ä¸ºtrue
æˆ–æ˜¯åœ¨æ¯é¡µåŸºç¡€ä¸Šå¯ç”¨MathJaxï¼Œåœ¨å†…å®¹æ–‡ä»¶ä¸­åŒ…æ‹¬å‚æ•°math: true
æ³¨æ„ï¼š ä½¿ç”¨æ”¯æŒçš„TeXåŠŸèƒ½ çš„è”æœºå‚è€ƒèµ„æ–™
ä¾‹å­ é‡å¤çš„åˆ†æ•° $$ \frac{1}{\Bigl(\sqrt{\phi \sqrt{5}}-\phi\Bigr) e^{\frac25 \pi}} \equiv 1+\frac{e^{-2\pi}} {1+\frac{e^{-4\pi}} {1+\frac{e^{-6\pi}} {1+\frac{e^{-8\pi}} {1+\cdots} } } } $$
æ€»å’Œè®°å· $$ \left( \sum_{k=1}^n a_k b_k \right)^2 \leq \left( \sum_{k=1}^n a_k^2 \right) \left( \sum_{k=1}^n b_k^2 \right) $$
å‡ ä½•çº§æ•°ä¹‹å’Œ æˆ‘æŠŠæ¥ä¸‹æ¥çš„ä¸¤ä¸ªä¾‹å­åˆ†æˆäº†å‡ è¡Œï¼Œè¿™æ ·å®ƒåœ¨æ‰‹æœºä¸Šè¡¨ç°å¾—æ›´å¥½ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒä»¬åŒ…å« \displaystyleã€‚
$$ \displaystyle\sum_{i=1}^{k+1}i $$
$$ \displaystyle= \left(\sum_{i=1}^{k}i\right) +(k+1) $$
$$ \displaystyle= \frac{k(k+1)}{2}+k+1 $$
$$ \displaystyle= \frac{k(k+1)+2(k+1)}{2} $$
$$ \displaystyle= \frac{(k+1)(k+2)}{2} $$
$$ \displaystyle= \frac{(k+1)((k+1)+1)}{2} $$
ä¹˜è®°å· $$ \displaystyle 1 + \frac{q^2}{(1-q)}+\frac{q^6}{(1-q)(1-q^2)}+\cdots = \displaystyle \prod_{j=0}^{\infty}\frac{1}{(1-q^{5j+2})(1-q^{5j+3})}, \displaystyle\text{ for }\lvert q\rvert &lt; 1. $$
éšæ–‡æ•°å¼ è¿™æ˜¯ä¸€äº›çº¿æ€§æ•°å­¦: $$ k_{n+1} = n^2 + k_n^2 - k_{n-1} $$ ï¼Œ ç„¶åæ˜¯æ›´å¤šçš„æ–‡æœ¬ã€‚
å¸Œè…Šå­—æ¯ $$ \Gamma\ \Delta\ \Theta\ \Lambda\ \Xi\ \Pi\ \Sigma\ \Upsilon\ \Phi\ \Psi\ \Omega \alpha\ \beta\ \gamma\ \delta\ \epsilon\ \zeta\ \eta\ \theta\ \iota\ \kappa\ \lambda\ \mu\ \nu\ \xi \ \omicron\ \pi\ \rho\ \sigma\ \tau\ \upsilon\ \phi\ \chi\ \psi\ \omega\ \varepsilon\ \vartheta\ \varpi\ \varrho\ \varsigma\ \varphi $$
ç®­å¤´ $$ \gets\ \to\ \leftarrow\ \rightarrow\ \uparrow\ \Uparrow\ \downarrow\ \Downarrow\ \updownarrow\ \Updownarrow $$
$$ \Leftarrow\ \Rightarrow\ \leftrightarrow\ \Leftrightarrow\ \mapsto\ \hookleftarrow \leftharpoonup\ \leftharpoondown\ \rightleftharpoons\ \longleftarrow\ \Longleftarrow\ \longrightarrow $$
$$ \Longrightarrow\ \longleftrightarrow\ \Longleftrightarrow\ \longmapsto\ \hookrightarrow\ \rightharpoonup $$
$$ \rightharpoondown\ \leadsto\ \nearrow\ \searrow\ \swarrow\ \nwarrow $$
ç¬¦å· $$ \surd\ \barwedge\ \veebar\ \odot\ \oplus\ \otimes\ \oslash\ \circledcirc\ \boxdot\ \bigtriangleup $$
$$ \bigtriangledown\ \dagger\ \diamond\ \star\ \triangleleft\ \triangleright\ \angle\ \infty\ \prime\ \triangle $$
å¾®ç§¯åˆ†å­¦ $$ \int u \frac{dv}{dx},dx=uv-\int \frac{du}{dx}v,dx $$
$$ f(x) = \int_{-\infty}^\infty \hat f(\xi),e^{2 \pi i \xi x} $$
$$ \oint \vec{F} \cdot d\vec{s}=0 $$
æ´›ä¼¦èŒ¨æ–¹ç¨‹ $$ \begin{aligned} \dot{x} &amp; = \sigma(y-x) \ \dot{y} &amp; = \rho x - y - xz \ \dot{z} &amp; = -\beta z + xy \end{aligned} $$
äº¤å‰ä¹˜ç§¯ è¿™åœ¨KaTeXä¸­æ˜¯å¯è¡Œçš„ï¼Œä½†åœ¨è¿™ç§ç¯å¢ƒä¸­é¦åˆ†çš„åˆ†ç¦»ä¸æ˜¯å¾ˆå¥½ã€‚
$$ \mathbf{V}_1 \times \mathbf{V}_2 = \begin{vmatrix} \mathbf{i} &amp; \mathbf{j} &amp; \mathbf{k} \ \frac{\partial X}{\partial u} &amp; \frac{\partial Y}{\partial u} &amp; 0 \ \frac{\partial X}{\partial v} &amp; \frac{\partial Y}{\partial v} &amp; 0 \end{vmatrix} $$
è¿™é‡Œæœ‰ä¸€ä¸ªè§£å†³æ–¹æ¡ˆ:ä½¿ç”¨â€œmfracâ€ç±»(åœ¨MathJaxæƒ…å†µä¸‹æ²¡æœ‰åŒºåˆ«)çš„é¢å¤–ç±»ä½¿åˆ†æ•°æ›´å°:
$$ \mathbf{V}_1 \times \mathbf{V}_2 = \begin{vmatrix} \mathbf{i} &amp; \mathbf{j} &amp; \mathbf{k} \ \frac{\partial X}{\partial u} &amp; \frac{\partial Y}{\partial u} &amp; 0 \ \frac{\partial X}{\partial v} &amp; \frac{\partial Y}{\partial v} &amp; 0 \end{vmatrix} $$
å¼ºè°ƒ $$ \hat{x}\ \vec{x}\ \ddot{x} $$
æœ‰å¼¹æ€§çš„æ‹¬å· $$ \left(\frac{x^2}{y^3}\right) $$
è¯„ä¼°èŒƒå›´ $$ \left.\frac{x^3}{3}\right|_0^1 $$
è¯Šæ–­æ ‡å‡† $$ f(n) = \begin{cases} \frac{n}{2}, &amp; \text{if } n\text{ is even} \ 3n+1, &amp; \text{if } n\text{ is odd} \end{cases} $$
éº¦å…‹æ–¯éŸ¦æ–¹ç¨‹ç»„ $$ \begin{aligned} \nabla \times \vec{\mathbf{B}} -, \frac1c, \frac{\partial\vec{\mathbf{E}}}{\partial t} &amp; = \frac{4\pi}{c}\vec{\mathbf{j}} \ \nabla \cdot \vec{\mathbf{E}} &amp; = 4 \pi \rho \ \nabla \times \vec{\mathbf{E}}, +, \frac1c, \frac{\partial\vec{\mathbf{B}}}{\partial t} &amp; = \vec{\mathbf{0}} \ \nabla \cdot \vec{\mathbf{B}} &amp; = 0 \end{aligned} $$
è¿™äº›æ–¹ç¨‹å¼å¾ˆç‹­çª„ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨(ä¾‹å¦‚)æ·»åŠ å‚ç›´é—´è· [1em] åœ¨æ¯ä¸ªæ¢è¡Œç¬¦(\)ä¹‹åã€‚æ­£å¦‚ä½ åœ¨è¿™é‡Œçœ‹åˆ°çš„ï¼š
$$ \begin{aligned} \nabla \times \vec{\mathbf{B}} -, \frac1c, \frac{\partial\vec{\mathbf{E}}}{\partial t} &amp; = \frac{4\pi}{c}\vec{\mathbf{j}} \[1em] \nabla \cdot \vec{\mathbf{E}} &amp; = 4 \pi \rho \[0.5em] \nabla \times \vec{\mathbf{E}}, +, \frac1c, \frac{\partial\vec{\mathbf{B}}}{\partial t} &amp; = \vec{\mathbf{0}} \[1em] \nabla \cdot \vec{\mathbf{B}} &amp; = 0 \end{aligned} $$
ç»Ÿè®¡å­¦ å›ºå®šè¯ç»„ï¼š
$$ \frac{n!}{k!(n-k)!} = {^n}C_k {n \choose k} $$
åˆ†æ•°åœ¨åˆ†æ•° $$ \frac{\frac{1}{x}+\frac{1}{y}}{y-z} $$
ï½æ¬¡æ–¹æ ¹ $$ \sqrt[n]{1+x+x^2+x^3+\ldots} $$
çŸ©é˜µ $$ \begin{pmatrix} a_{11} &amp; a_{12} &amp; a_{13}\ a_{21} &amp; a_{22} &amp; a_{23}\ a_{31} &amp; a_{32} &amp; a_{33} \end{pmatrix} \begin{bmatrix} 0 &amp; \cdots &amp; 0 \ \vdots &amp; \ddots &amp; \vdots \ 0 &amp; \cdots &amp; 0 \end{bmatrix} $$
æ ‡ç‚¹ç¬¦å· $$ f(x) = \sqrt{1+x} \quad (x \ge -1) f(x) \sim x^2 \quad (x\to\infty) $$
ç°åœ¨ç”¨æ ‡ç‚¹ç¬¦å·:
$$ f(x) = \sqrt{1+x}, \quad x \ge -1 f(x) \sim x^2, \quad x\to\infty $$</content></entry><entry><title>æ”¯æŒEmojiè¡¨æƒ…ç¬¦å·</title><url>/post/emoji-support/</url><categories/><tags><tag>emoji</tag></tags><content type="html"> Emoji è¡¨æƒ…ç¬¦å·å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼åœ¨ Hugo é¡¹ç›®ä¸­å¯ç”¨ã€‚
ä½¿ç”¨ Emoji è¡¨æƒ…ç¬¦å·å¯ä»¥åœ¨æ¨¡æ¿ä¸­å¯ä»¥ç›´æ¥è°ƒç”¨ emojify å‡½æ•°æˆ–æ˜¯é€šè¿‡ å†…è”çŸ­ä»£ç  æ¥å®ç°ã€‚
å¦‚æœè¦å…¨å±€å¯ç”¨ Emoji è¡¨æƒ…ç¬¦å·ï¼Œè¯·åœ¨ç½‘ç«™é…ç½® æ–‡ä»¶ä¸­å°† enableEmoji å‚æ•°å€¼è®¾ç½®ä¸º trueï¼Œç„¶åå¯ä»¥ç›´æ¥åœ¨å†…å®¹æ–‡ä»¶ä¸­è¾“å…¥è¡¨æƒ…ç¬¦å·ç®€å†™ä»£ç ï¼Œå‚è€ƒå¦‚ä¸‹ï¼š
çŒ´å­è¡¨æƒ… ğŸ™ˆ ğŸ™ˆ ğŸ™‰ ğŸ™‰ ğŸ™Š ğŸ™Š æ•°å­—ç¬¦å· 1ï¸âƒ£ 1ï¸âƒ£ 2ï¸âƒ£ 2ï¸âƒ£ 3ï¸âƒ£ 3ï¸âƒ£ å»ºç­‘ç‰© ğŸ¡ ğŸ¡ ğŸ£ ğŸ£ ğŸ¥ ğŸ¥ æ›´å¤šçš„ Emoji è¡¨æƒ…ç¬¦å·ä»£ç å¯å‚è€ƒEmoji é…å¯¹ç›®å½• ã€‚
æ³¨æ„: ä»¥ä¸Šæ­¥éª¤åœ¨ Hugo ä¸­å¯ç”¨ Unicode æ ‡å‡†è¡¨æƒ…ç¬¦å·å’Œåºåˆ—ï¼Œä½†æ˜¯è¿™äº›ç¬¦å·çš„å‘ˆç°å–å†³äºæµè§ˆå™¨å’Œå¹³å°ï¼Œè¦è®¾ç½®è¡¨æƒ…ç¬¦å·çš„æ ·å¼ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹è¡¨æƒ…ç¬¦å·å­—ä½“æˆ–å­—ä½“ã€‚ä¾‹å¦‚ï¼š
.emoji { font-family: Apple Color Emoji,Segoe UI Emoji,NotoColorEmoji,Segoe UI Symbol,Android Emoji,EmojiSymbols; }</content></entry><entry><title>å…³äºæˆ‘</title><url>/about.html</url><categories/><tags/><content type="html"> Hugoæ˜¯ç”¨Goç¼–å†™çš„ä¸€ä¸ªå¼€æ”¾æºä»£ç é™æ€ç«™ç‚¹ç”Ÿæˆå™¨ï¼Œå¯åœ¨Apacheè®¸å¯è¯2.0 ä¸‹ä½¿ç”¨ã€‚ Hugoæ”¯æŒTOML, YAMLå’ŒJSONæ•°æ®æ–‡ä»¶ç±»å‹ï¼ŒMarkdownå’ŒHTMLå†…å®¹æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨çŸ­ä»£ç æ·»åŠ ä¸°å¯Œçš„å†…å®¹ã€‚å…¶ä»–å€¼å¾—æ³¨æ„çš„åŠŸèƒ½åŒ…æ‹¬åˆ†ç±»æ³•ã€å¤šè¯­è¨€æ¨¡å¼ã€å›¾åƒå¤„ç†ã€è‡ªå®šä¹‰è¾“å‡ºæ ¼å¼ã€HTML/CSS/JSç¼©å°å’Œå¯¹Sass SCSSå·¥ä½œæµçš„æ”¯æŒã€‚
Hugoä½¿ç”¨äº†å¤šç§å¼€æºé¡¹ç›®ï¼ŒåŒ…æ‹¬:
https://github.com/yuin/goldmark https://github.com/alecthomas/chroma https://github.com/muesli/smartcrop https://github.com/spf13/cobra https://github.com/spf13/viper Hugoæ˜¯åšå®¢ã€ä¼ä¸šç½‘ç«™ã€åˆ›æ„ä½œå“é›†ã€åœ¨çº¿æ‚å¿—ã€å•é¡µåº”ç”¨ç¨‹åºç”šè‡³æ˜¯æ•°åƒé¡µçš„ç½‘ç«™çš„ç†æƒ³é€‰æ‹©ã€‚
Hugoé€‚åˆé‚£äº›æƒ³è¦æ‰‹å·¥ç¼–å†™è‡ªå·±çš„ç½‘ç«™ä»£ç ï¼Œè€Œä¸ç”¨æ‹…å¿ƒè®¾ç½®å¤æ‚çš„è¿è¡Œæ—¶ã€ä¾èµ–å…³ç³»å’Œæ•°æ®åº“çš„äººã€‚
ä½¿ç”¨Hugoå»ºç«‹çš„ç½‘ç«™éå¸¸å¿«é€Ÿã€å®‰å…¨ï¼Œå¯ä»¥éƒ¨ç½²åœ¨ä»»ä½•åœ°æ–¹ï¼ŒåŒ…æ‹¬AWSã€GitHub Pagesã€Herokuã€Netlifyå’Œä»»ä½•å…¶ä»–æ‰˜ç®¡æä¾›å•†ã€‚
æ›´å¤šä¿¡æ¯è¯·è®¿é—®GitHub .</content></entry><entry><title>Go Channel åº•å±‚å®ç°</title><url>/post/go-channel/</url><categories/><tags><tag>golang</tag></tags><content type="html"> Go Channel åº•å±‚å®ç° ç›®å½• channel æ˜¯ä»€ä¹ˆ channel çš„åˆ›å»º channel çš„å‘é€ channel çš„æ¥æ”¶ channel çš„å…³é—­ channel æ˜¯ä»€ä¹ˆ â€œDo not communicate by sharing memory; instead, share memory by communicating.â€
ä¸è¦é€šè¿‡å…±äº«å†…å­˜é€šä¿¡ï¼Œé€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜ã€‚å¾ˆç»å…¸çš„goçš„å¹¶å‘å“²å­¦ï¼Œä¾èµ–cspæ¨¡å‹ï¼Œ é€šè¿‡channelå®ç°ã€‚
goçš„å¹¶å‘ä¸»è¦é goroutineå®ç°çš„ï¼Œè€Œchannelåˆ™åƒä¸€ä¸ªç®¡é“ä¸€æ ·ï¼Œ å®ç°goroutineä¹‹é—´çš„é€šä¿¡ã€‚è™½ç„¶ä¹Ÿå¯ä»¥é€šè¿‡é”ï¼ŒåŸå­æ“ä½œèƒ½å¤Ÿå®ç°æ•°æ®çš„åŒæ­¥ï¼Œä½†ä½¿ç”¨channelæ›´ä¼˜é›…ã€‚
æ€»ç»“ä¸€ä¸‹ï¼Œchannel æ˜¯å¹¶å‘å®‰å…¨çš„ç®¡é“ï¼Œä¸»è¦ç”¨äºgoroutineä¹‹é—´çš„æ¶ˆæ¯ä¼ é€’å’Œäº‹ä»¶é€šçŸ¥ã€‚
å†æ¥çœ‹ä¸€ä¸‹åœ¨goä¸­channelçš„æ•°æ®ç»“æ„
type hchan struct { // å…ƒç´ æ•°é‡ qcount uint // åº•å±‚å¾ªç¯æ•°ç»„çš„é•¿åº¦ dataqsiz uint // æŒ‡å‘åº•å±‚å¾ªç¯æ•°ç»„çš„æŒ‡é’ˆ buf unsafe.Pointer // å…ƒç´ å¤§å° elemsize uint16 // æ˜¯å¦è¢«å…³é—­ closed uint32 // å…ƒç´ ç±»å‹ elemtype *_type // å·²å‘é€å…ƒç´ åœ¨å¾ªç¯æ•°ç»„ä¸­çš„ç´¢å¼• sendx uint // å·²æ¥æ”¶å…ƒç´ åœ¨å¾ªç¯æ•°ç»„ä¸­çš„ç´¢å¼• recvx uint // ç­‰å¾…æ¥æ”¶çš„ goroutine é˜Ÿåˆ— recvq waitq // ç­‰å¾…å‘é€çš„ goroutine é˜Ÿåˆ— sendq waitq // é” lock mutex } ç»“åˆä¸‹å›¾æ›´ç›´è§‚çš„çœ‹ä¸€ä¸‹
channel çš„åˆ›å»º æ ¹æ®channelçš„sizeåˆ†ä¸ºæ— ç¼“å†²å’Œæœ‰ç¼“å†²channel
// æ— ç¼“å†²channel ch1 := make(chan int) // æœ‰ç¼“å†²channel ch2 := make(chan int, 2) æ ¹æ®channelçš„å‘é€æ¥æ”¶èƒ½åŠ›æ¥å°†å®ƒåˆ†ä¸ºä¸‰ç§ç±»å‹, ä¸æŒ‡æ˜æ–¹å‘çš„channelæŠ€èƒ½å‘é€ä¹Ÿèƒ½æ¥æ”¶ï¼Œ&lt;-chan åªèƒ½å‘é€ï¼Œ chan&lt;- åªèƒ½æ¥æ”¶ã€‚
// å¯ä»¥å‘é€å’Œæ¥æ”¶Tç±»å‹çš„æ•°æ® chan T // åªèƒ½å‘é€Tç±»å‹çš„æ•°æ® chan &lt;- T // åªèƒ½æ¥æ”¶Tç±»å‹çš„æ•°æ® &lt;-chan T ä½¿ç”¨makeå‡½æ•°å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªèƒ½å¤Ÿæ”¶å‘çš„channel, åªèƒ½è¯»æˆ–è€…å†™çš„channel ä¸€èˆ¬ä½œä¸ºå‡½æ•°å‚æ•°åšé™åˆ¶
var wg sync.WaitGroup ch1 := make(chan int) ch2 := make(chan int, 2) wg.Add(2) // åªèƒ½ä»recvChæ¥æ”¶æ•°æ® go func(recvCh &lt;-chan int) { data := &lt;-recvCh fmt.Println(data) wg.Done() }(ch1) // åªèƒ½å‘sendChå‘é€æ•°æ® go func(sendCh chan&lt;- int) { sendCh &lt;- 1 wg.Done() }(ch2) wg.Wait() make å‡½æ•°æœ€ç»ˆè°ƒç”¨äº† /go/src/runtime/chan.go ä¸‹é¢çš„makechanæ–¹æ³•ï¼Œä¸»è¦åšäº†chançš„åˆå§‹åŒ–å†…å­˜åˆ†é…
func makechan(t *chantype, size int) *hchan { elem := t.elem // compiler checks this but be safe. if elem.size >= 1&lt;&lt;16 { throw("makechan: invalid channel element type") } if hchanSize%maxAlign != 0 || elem.align > maxAlign { throw("makechan: bad alignment") } mem, overflow := math.MulUintptr(elem.size, uintptr(size)) if overflow || mem > maxAlloc-hchanSize || size &lt; 0 { panic(plainError("makechan: size out of range")) } // Hchan does not contain pointers interesting for GC when elements stored in buf do not contain pointers. // buf points into the same allocation, elemtype is persistent. // SudoG's are referenced from their owning thread so they can't be collected. // TODO(dvyukov,rlh): Rethink when collector can move allocated objects. var c *hchan switch { case mem == 0: // Queue or element size is zero. c = (*hchan)(mallocgc(hchanSize, nil, true)) // Race detector uses this location for synchronization. c.buf = c.raceaddr() case elem.ptrdata == 0: // Elements do not contain pointers. // Allocate hchan and buf in one call. c = (*hchan)(mallocgc(hchanSize+mem, nil, true)) c.buf = add(unsafe.Pointer(c), hchanSize) default: // Elements contain pointers. c = new(hchan) c.buf = mallocgc(mem, elem, true) } c.elemsize = uint16(elem.size) c.elemtype = elem c.dataqsiz = uint(size) lockInit(&amp;c.lock, lockRankHchan) if debugChan { print("makechan: chan=", c, "; elemsize=", elem.size, "; dataqsiz=", size, "\n") } return c } channelçš„å‘é€ ch := make(chan int, 3) ch &lt;- 1 channelçš„å‘é€çš„ä»£ç å¾ˆç®€å•ï¼Œä¸è¿‡è¿™åªæ˜¯ç¼–è¯‘å™¨è¡¨é¢çš„è¯­æ³•ç³–è€Œå·²ï¼Œ å®é™…ä¸Šè°ƒç”¨äº†runtime.chansendå‡½æ•°
// ä½äº src/runtime/chan.go func chansend(c *hchan, ep unsafe.Pointer, block bool, callerpc uintptr) bool { // å¦‚æœ channel æ˜¯ nil if c == nil { // ä¸èƒ½é˜»å¡ï¼Œç›´æ¥è¿”å› falseï¼Œè¡¨ç¤ºæœªå‘é€æˆåŠŸ if !block { return false } // å½“å‰ goroutine è¢«æŒ‚èµ· gopark(nil, nil, "chan send (nil chan)", traceEvGoStop, 2) throw("unreachable") } // çœç•¥ debug ç›¸å…³â€¦â€¦ // å¯¹äºä¸é˜»å¡çš„ sendï¼Œå¿«é€Ÿæ£€æµ‹å¤±è´¥åœºæ™¯ // // å¦‚æœ channel æœªå…³é—­ä¸” channel æ²¡æœ‰å¤šä½™çš„ç¼“å†²ç©ºé—´ã€‚è¿™å¯èƒ½æ˜¯ï¼š // 1. channel æ˜¯éç¼“å†²å‹çš„ï¼Œä¸”ç­‰å¾…æ¥æ”¶é˜Ÿåˆ—é‡Œæ²¡æœ‰ goroutine // 2. channel æ˜¯ç¼“å†²å‹çš„ï¼Œä½†å¾ªç¯æ•°ç»„å·²ç»è£…æ»¡äº†å…ƒç´  if !block &amp;&amp; c.closed == 0 &amp;&amp; ((c.dataqsiz == 0 &amp;&amp; c.recvq.first == nil) || (c.dataqsiz > 0 &amp;&amp; c.qcount == c.dataqsiz)) { return false } var t0 int64 if blockprofilerate > 0 { t0 = cputicks() } // é”ä½ channelï¼Œå¹¶å‘å®‰å…¨ lock(&amp;c.lock) // å¦‚æœ channel å…³é—­äº† if c.closed != 0 { // è§£é” unlock(&amp;c.lock) // ç›´æ¥ panic panic(plainError("send on closed channel")) } // å¦‚æœæ¥æ”¶é˜Ÿåˆ—é‡Œæœ‰ goroutineï¼Œç›´æ¥å°†è¦å‘é€çš„æ•°æ®æ‹·è´åˆ°æ¥æ”¶ goroutine if sg := c.recvq.dequeue(); sg != nil { send(c, sg, ep, func() { unlock(&amp;c.lock) }, 3) return true } // å¯¹äºç¼“å†²å‹çš„ channelï¼Œå¦‚æœè¿˜æœ‰ç¼“å†²ç©ºé—´ if c.qcount &lt; c.dataqsiz { // qp æŒ‡å‘ buf çš„ sendx ä½ç½® qp := chanbuf(c, c.sendx) // â€¦â€¦ // å°†æ•°æ®ä» ep å¤„æ‹·è´åˆ° qp typedmemmove(c.elemtype, qp, ep) // å‘é€æ¸¸æ ‡å€¼åŠ  1 c.sendx++ // å¦‚æœå‘é€æ¸¸æ ‡å€¼ç­‰äºå®¹é‡å€¼ï¼Œæ¸¸æ ‡å€¼å½’ 0 if c.sendx == c.dataqsiz { c.sendx = 0 } // ç¼“å†²åŒºçš„å…ƒç´ æ•°é‡åŠ ä¸€ c.qcount++ // è§£é” unlock(&amp;c.lock) return true } // å¦‚æœä¸éœ€è¦é˜»å¡ï¼Œåˆ™ç›´æ¥è¿”å›é”™è¯¯ if !block { unlock(&amp;c.lock) return false } // channel æ»¡äº†ï¼Œå‘é€æ–¹ä¼šè¢«é˜»å¡ã€‚æ¥ä¸‹æ¥ä¼šæ„é€ ä¸€ä¸ª sudog // è·å–å½“å‰ goroutine çš„æŒ‡é’ˆ gp := getg() mysg := acquireSudog() mysg.releasetime = 0 if t0 != 0 { mysg.releasetime = -1 } mysg.elem = ep mysg.waitlink = nil mysg.g = gp mysg.selectdone = nil mysg.c = c gp.waiting = mysg gp.param = nil // å½“å‰ goroutine è¿›å…¥å‘é€ç­‰å¾…é˜Ÿåˆ— c.sendq.enqueue(mysg) // å½“å‰ goroutine è¢«æŒ‚èµ· goparkunlock(&amp;c.lock, "chan send", traceEvGoBlockSend, 3) // ä»è¿™é‡Œå¼€å§‹è¢«å”¤é†’äº†ï¼ˆchannel æœ‰æœºä¼šå¯ä»¥å‘é€äº†ï¼‰ if mysg != gp.waiting { throw("G waiting list is corrupted") } gp.waiting = nil if gp.param == nil { if c.closed == 0 { throw("chansend: spurious wakeup") } // è¢«å”¤é†’åï¼Œchannel å…³é—­äº†ã€‚å‘çˆ¹å•Šï¼Œpanic panic(plainError("send on closed channel")) } gp.param = nil if mysg.releasetime > 0 { blockevent(mysg.releasetime-t0, 2) } // å»æ‰ mysg ä¸Šç»‘å®šçš„ channel mysg.c = nil releaseSudog(mysg) return true } ä¸Šé¢çš„ä»£ç æ³¨é‡Šå¾ˆæ¸…æ¥šè¯´æ˜äº†channelçš„å‘é€æµç¨‹ï¼Œä¸‹é¢å°ç»“ä¸€ä¸‹å‘é€çš„è¿‡ç¨‹ï¼š
å‘ä¸€ä¸ªnil channelå‘é€æ•°æ®ï¼Œä¼šè°ƒç”¨goparkå‡½æ•°å°†å½“å‰goroutineæŒ‚èµ· å‘ä¸€ä¸ªå·²ç»å…³é—­çš„channelå‘é€æ•°æ®ï¼Œç›´æ¥ä¼španic å¦‚æœchannelçš„recvqå½“å‰é˜Ÿåˆ—ä¸­æœ‰è¢«é˜»å¡çš„æ¥æ”¶è€…ï¼Œåˆ™ç›´æ¥å°†æ•°æ®å‘é€ç»™å½“å‰goroutine, å¹¶å°†å®ƒè®¾ç½®æˆä¸‹ä¸€ä¸ªè¿è¡Œçš„goroutine å½“channelçš„ç¼“å†²åŒºè¿˜æœ‰ç©ºé—²ç©ºé—´ï¼Œåˆ™å°†æ•°æ®å‘é€åˆ°sendxæŒ‡å‘ç¼“å†²åŒºçš„ä½ç½® å½“æ²¡æœ‰ç¼“å†²åŒºæˆ–è€…ç¼“å†²åŒºæ»¡äº†ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªsudogçš„ç»“æ„ä½“å°†å…¶æ”¾åˆ°channelçš„sendqé˜Ÿåˆ—å½“ä¸­é™·å…¥ä¼‘çœ ç­‰å¾…è¢«å”¤é†’ channel çš„æ¥æ”¶ ch := make(chan int) // ä¸å¸¦okçš„æ–¹å¼ data := &lt;- ch // å¸¦okçš„æ–¹å¼ data, ok := &lt;-ch channelçš„æ¥æ”¶åˆ†ä¸ºä¸¤ç§æ–¹å¼ï¼Œä¹Ÿæ˜¯ç¼–è¯‘å™¨è¯­æ³•ç³–çš„ç»“æœï¼Œæœ€ç»ˆä¼šè°ƒç”¨runtime.chanrecv1 å’Œ runtime.chanrecv2,è€Œè¿™ä¸¤ä¸ªå‡½æ•°æœ€ç»ˆè°ƒç”¨äº†runtime.chanrecv
// entry points for &lt;- c from compiled code func chanrecv1(c *hchan, elem unsafe.Pointer) { chanrecv(c, elem, true) } func chanrecv2(c *hchan, elem unsafe.Pointer) (received bool) { _, received = chanrecv(c, elem, true) return } æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹chanrecvçš„ä»£ç 
// ä½äº src/runtime/chan.go // chanrecv å‡½æ•°æ¥æ”¶ channel c çš„å…ƒç´ å¹¶å°†å…¶å†™å…¥ ep æ‰€æŒ‡å‘çš„å†…å­˜åœ°å€ã€‚ // å¦‚æœ ep æ˜¯ nilï¼Œè¯´æ˜å¿½ç•¥äº†æ¥æ”¶å€¼ã€‚ // å¦‚æœ block == falseï¼Œå³éé˜»å¡å‹æ¥æ”¶ï¼Œåœ¨æ²¡æœ‰æ•°æ®å¯æ¥æ”¶çš„æƒ…å†µä¸‹ï¼Œè¿”å› (false, false) // å¦åˆ™ï¼Œå¦‚æœ c å¤„äºå…³é—­çŠ¶æ€ï¼Œå°† ep æŒ‡å‘çš„åœ°å€æ¸…é›¶ï¼Œè¿”å› (true, false) // å¦åˆ™ï¼Œç”¨è¿”å›å€¼å¡«å…… ep æŒ‡å‘çš„å†…å­˜åœ°å€ã€‚è¿”å› (true, true) // å¦‚æœ ep éç©ºï¼Œåˆ™åº”è¯¥æŒ‡å‘å †æˆ–è€…å‡½æ•°è°ƒç”¨è€…çš„æ ˆ func chanrecv(c *hchan, ep unsafe.Pointer, block bool) (selected, received bool) { // çœç•¥ debug å†…å®¹ â€¦â€¦â€¦â€¦ // å¦‚æœæ˜¯ä¸€ä¸ª nil çš„ channel if c == nil { // å¦‚æœä¸é˜»å¡ï¼Œç›´æ¥è¿”å› (false, false) if !block { return } // å¦åˆ™ï¼Œæ¥æ”¶ä¸€ä¸ª nil çš„ channelï¼Œgoroutine æŒ‚èµ· gopark(nil, nil, "chan receive (nil chan)", traceEvGoStop, 2) // ä¸ä¼šæ‰§è¡Œåˆ°è¿™é‡Œ throw("unreachable") } // åœ¨éé˜»å¡æ¨¡å¼ä¸‹ï¼Œå¿«é€Ÿæ£€æµ‹åˆ°å¤±è´¥ï¼Œä¸ç”¨è·å–é”ï¼Œå¿«é€Ÿè¿”å› // å½“æˆ‘ä»¬è§‚å¯Ÿåˆ° channel æ²¡å‡†å¤‡å¥½æ¥æ”¶ï¼š // 1. éç¼“å†²å‹ï¼Œç­‰å¾…å‘é€åˆ—é˜Ÿ sendq é‡Œæ²¡æœ‰ goroutine åœ¨ç­‰å¾… // 2. ç¼“å†²å‹ï¼Œä½† buf é‡Œæ²¡æœ‰å…ƒç´  // ä¹‹åï¼Œåˆè§‚å¯Ÿåˆ° closed == 0ï¼Œå³ channel æœªå…³é—­ã€‚ // å› ä¸º channel ä¸å¯èƒ½è¢«é‡å¤æ‰“å¼€ï¼Œæ‰€ä»¥å‰ä¸€ä¸ªè§‚æµ‹çš„æ—¶å€™ channel ä¹Ÿæ˜¯æœªå…³é—­çš„ï¼Œ // å› æ­¤åœ¨è¿™ç§æƒ…å†µä¸‹å¯ä»¥ç›´æ¥å®£å¸ƒæ¥æ”¶å¤±è´¥ï¼Œè¿”å› (false, false) if !block &amp;&amp; (c.dataqsiz == 0 &amp;&amp; c.sendq.first == nil || c.dataqsiz > 0 &amp;&amp; atomic.Loaduint(&amp;c.qcount) == 0) &amp;&amp; atomic.Load(&amp;c.closed) == 0 { return } var t0 int64 if blockprofilerate > 0 { t0 = cputicks() } // åŠ é” lock(&amp;c.lock) // channel å·²å…³é—­ï¼Œå¹¶ä¸”å¾ªç¯æ•°ç»„ buf é‡Œæ²¡æœ‰å…ƒç´  // è¿™é‡Œå¯ä»¥å¤„ç†éç¼“å†²å‹å…³é—­ å’Œ ç¼“å†²å‹å…³é—­ä½† buf æ— å…ƒç´ çš„æƒ…å†µ // ä¹Ÿå°±æ˜¯è¯´å³ä½¿æ˜¯å…³é—­çŠ¶æ€ï¼Œä½†åœ¨ç¼“å†²å‹çš„ channelï¼Œ // buf é‡Œæœ‰å…ƒç´ çš„æƒ…å†µä¸‹è¿˜èƒ½æ¥æ”¶åˆ°å…ƒç´  if c.closed != 0 &amp;&amp; c.qcount == 0 { if raceenabled { raceacquire(unsafe.Pointer(c)) } // è§£é” unlock(&amp;c.lock) if ep != nil { // ä»ä¸€ä¸ªå·²å…³é—­çš„ channel æ‰§è¡Œæ¥æ”¶æ“ä½œï¼Œä¸”æœªå¿½ç•¥è¿”å›å€¼ // é‚£ä¹ˆæ¥æ”¶çš„å€¼å°†æ˜¯ä¸€ä¸ªè¯¥ç±»å‹çš„é›¶å€¼ // typedmemclr æ ¹æ®ç±»å‹æ¸…ç†ç›¸åº”åœ°å€çš„å†…å­˜ typedmemclr(c.elemtype, ep) } // ä»ä¸€ä¸ªå·²å…³é—­çš„ channel æ¥æ”¶ï¼Œselected ä¼šè¿”å›true return true, false } // ç­‰å¾…å‘é€é˜Ÿåˆ—é‡Œæœ‰ goroutine å­˜åœ¨ï¼Œè¯´æ˜ buf æ˜¯æ»¡çš„ // è¿™æœ‰å¯èƒ½æ˜¯ï¼š // 1. éç¼“å†²å‹çš„ channel // 2. ç¼“å†²å‹çš„ channelï¼Œä½† buf æ»¡äº† // é’ˆå¯¹ 1ï¼Œç›´æ¥è¿›è¡Œå†…å­˜æ‹·è´ï¼ˆä» sender goroutine -> receiver goroutineï¼‰ // é’ˆå¯¹ 2ï¼Œæ¥æ”¶åˆ°å¾ªç¯æ•°ç»„å¤´éƒ¨çš„å…ƒç´ ï¼Œå¹¶å°†å‘é€è€…çš„å…ƒç´ æ”¾åˆ°å¾ªç¯æ•°ç»„å°¾éƒ¨ if sg := c.sendq.dequeue(); sg != nil { // Found a waiting sender. If buffer is size 0, receive value // directly from sender. Otherwise, receive from head of queue // and add sender's value to the tail of the queue (both map to // the same buffer slot because the queue is full). recv(c, sg, ep, func() { unlock(&amp;c.lock) }, 3) return true, true } // ç¼“å†²å‹ï¼Œbuf é‡Œæœ‰å…ƒç´ ï¼Œå¯ä»¥æ­£å¸¸æ¥æ”¶ if c.qcount > 0 { // ç›´æ¥ä»å¾ªç¯æ•°ç»„é‡Œæ‰¾åˆ°è¦æ¥æ”¶çš„å…ƒç´  qp := chanbuf(c, c.recvx) // â€¦â€¦â€¦â€¦ // ä»£ç é‡Œï¼Œæ²¡æœ‰å¿½ç•¥è¦æ¥æ”¶çš„å€¼ï¼Œä¸æ˜¯ "&lt;- ch"ï¼Œè€Œæ˜¯ "val &lt;- ch"ï¼Œep æŒ‡å‘ val if ep != nil { typedmemmove(c.elemtype, ep, qp) } // æ¸…ç†æ‰å¾ªç¯æ•°ç»„é‡Œç›¸åº”ä½ç½®çš„å€¼ typedmemclr(c.elemtype, qp) // æ¥æ”¶æ¸¸æ ‡å‘å‰ç§»åŠ¨ c.recvx++ // æ¥æ”¶æ¸¸æ ‡å½’é›¶ if c.recvx == c.dataqsiz { c.recvx = 0 } // buf æ•°ç»„é‡Œçš„å…ƒç´ ä¸ªæ•°å‡ 1 c.qcount-- // è§£é” unlock(&amp;c.lock) return true, true } if !block { // éé˜»å¡æ¥æ”¶ï¼Œè§£é”ã€‚selected è¿”å› falseï¼Œå› ä¸ºæ²¡æœ‰æ¥æ”¶åˆ°å€¼ unlock(&amp;c.lock) return false, false } // æ¥ä¸‹æ¥å°±æ˜¯è¦è¢«é˜»å¡çš„æƒ…å†µäº† // æ„é€ ä¸€ä¸ª sudog gp := getg() mysg := acquireSudog() mysg.releasetime = 0 if t0 != 0 { mysg.releasetime = -1 } // å¾…æ¥æ”¶æ•°æ®çš„åœ°å€ä¿å­˜ä¸‹æ¥ mysg.elem = ep mysg.waitlink = nil gp.waiting = mysg mysg.g = gp mysg.selectdone = nil mysg.c = c gp.param = nil // è¿›å…¥channel çš„ç­‰å¾…æ¥æ”¶é˜Ÿåˆ— c.recvq.enqueue(mysg) // å°†å½“å‰ goroutine æŒ‚èµ· goparkunlock(&amp;c.lock, "chan receive", traceEvGoBlockRecv, 3) // è¢«å”¤é†’äº†ï¼Œæ¥ç€ä»è¿™é‡Œç»§ç»­æ‰§è¡Œä¸€äº›æ‰«å°¾å·¥ä½œ if mysg != gp.waiting { throw("G waiting list is corrupted") } gp.waiting = nil if mysg.releasetime > 0 { blockevent(mysg.releasetime-t0, 2) } closed := gp.param == nil gp.param = nil mysg.c = nil releaseSudog(mysg) return true, !closed } ä¸Šé¢çš„ä»£ç æ³¨é‡Šå¾ˆæ¸…æ¥šè¯´æ˜äº†channelçš„æ¥æ”¶æ•°æ®çš„æµç¨‹ï¼Œä¸‹é¢å°ç»“ä¸€ä¸‹æ¥æ”¶æ•°æ®çš„è¿‡ç¨‹ï¼š
ä»ä¸€ä¸ªnil channelæ¥æ”¶æ•°æ®ï¼Œä¼šè°ƒç”¨goparkå‡½æ•°å°†å½“å‰goroutineæŒ‚èµ·ï¼Œè®©å‡ºå¤„ç†å™¨çš„ä½¿ç”¨æƒ ä»ä¸€ä¸ªå·²ç»å…³é—­å¹¶ä¸”ç¼“å†²åŒºä¸­æ²¡æœ‰å…ƒç´ çš„channelä¸­æ¥æ”¶æ•°æ®ï¼Œåˆ™ä¼šæ¥æ”¶åˆ°è¯¥ç±»å‹çš„é»˜è®¤å…ƒç´ ï¼Œå¹¶ä¸”ç¬¬äºŒä¸ªè¿”å›å€¼è¿”å›false å¦‚æœchannelæ²¡æœ‰ç¼“å†²åŒºä¸”sendqçš„é˜Ÿåˆ—æœ‰é˜»å¡çš„goroutineï¼Œåˆ™æŠŠsendqé˜Ÿåˆ—å¤´çš„sudogä¸­ä¿å­˜çš„å…ƒç´ å€¼copyåˆ°ç›®æ ‡åœ°å€ä¸­ å¦‚æœchannelæœ‰ç¼“å†²åŒºä¸”ç¼“å†²åŒºé‡Œé¢æœ‰å…ƒç´ ï¼Œåˆ™æŠŠrecvxæŒ‡å‘ç¼“å†²åŒºçš„å…ƒç´ å€¼copyåˆ°ç›®æ ‡åœ°å€å½“ä¸­ï¼Œsendqé˜Ÿåˆ—å¤´çš„sudogçš„å…ƒç´ å€¼copyåˆ°recvxæŒ‡å‘ç¼“å†²åŒºä½ç½®çš„åœ°å€å½“ä¸­, è¿™å—æœ‰ç‚¹ä¸å¤ªå¥½ç†è§£ï¼Œçœ‹ä¸‹å›¾ 5. å½“ä¸Šé¢çš„æ¡ä»¶éƒ½ä¸ç¬¦åˆæ—¶ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªsudogçš„ç»“æ„ä½“å°†å…¶æ”¾åˆ°channelçš„recvqé˜Ÿåˆ—å½“ä¸­é™·å…¥ä¼‘çœ ç­‰å¾…è¢«å”¤é†’
channelçš„å…³é—­ ch := make(chan int) close(ch) å…³é—­channelç›¸å¯¹ç®€å•ï¼Œç¼–è¯‘å™¨ä¼šè½¬æ¢æˆruntime.closechanå‡½æ•°
func closechan(c *hchan) { // å…³é—­ä¸€ä¸ª nil channelï¼Œpanic if c == nil { panic(plainError("close of nil channel")) } // ä¸Šé” lock(&amp;c.lock) // å¦‚æœ channel å·²ç»å…³é—­ if c.closed != 0 { unlock(&amp;c.lock) // panic panic(plainError("close of closed channel")) } // â€¦â€¦â€¦â€¦ // ä¿®æ”¹å…³é—­çŠ¶æ€ c.closed = 1 var glist *g // å°† channel æ‰€æœ‰ç­‰å¾…æ¥æ”¶é˜Ÿåˆ—çš„é‡Œ sudog é‡Šæ”¾ for { // ä»æ¥æ”¶é˜Ÿåˆ—é‡Œå‡ºé˜Ÿä¸€ä¸ª sudog sg := c.recvq.dequeue() // å‡ºé˜Ÿå®Œæ¯•ï¼Œè·³å‡ºå¾ªç¯ if sg == nil { break } // å¦‚æœ elem ä¸ä¸ºç©ºï¼Œè¯´æ˜æ­¤ receiver æœªå¿½ç•¥æ¥æ”¶æ•°æ® // ç»™å®ƒèµ‹ä¸€ä¸ªç›¸åº”ç±»å‹çš„é›¶å€¼ if sg.elem != nil { typedmemclr(c.elemtype, sg.elem) sg.elem = nil } if sg.releasetime != 0 { sg.releasetime = cputicks() } // å–å‡º goroutine gp := sg.g gp.param = nil if raceenabled { raceacquireg(gp, unsafe.Pointer(c)) } // ç›¸è¿ï¼Œå½¢æˆé“¾è¡¨ gp.schedlink.set(glist) glist = gp } // å°† channel ç­‰å¾…å‘é€é˜Ÿåˆ—é‡Œçš„ sudog é‡Šæ”¾ // å¦‚æœå­˜åœ¨ï¼Œè¿™äº› goroutine å°†ä¼š panic for { // ä»å‘é€é˜Ÿåˆ—é‡Œå‡ºé˜Ÿä¸€ä¸ª sudog sg := c.sendq.dequeue() if sg == nil { break } // å‘é€è€…ä¼š panic sg.elem = nil if sg.releasetime != 0 { sg.releasetime = cputicks() } gp := sg.g gp.param = nil if raceenabled { raceacquireg(gp, unsafe.Pointer(c)) } // å½¢æˆé“¾è¡¨ gp.schedlink.set(glist) glist = gp } // è§£é” unlock(&amp;c.lock) // Ready all Gs now that we've dropped the channel lock. // éå†é“¾è¡¨ for glist != nil { // å–æœ€åä¸€ä¸ª gp := glist // å‘å‰èµ°ä¸€æ­¥ï¼Œä¸‹ä¸€ä¸ªå”¤é†’çš„ g glist = glist.schedlink.ptr() gp.schedlink = 0 // å”¤é†’ç›¸åº” goroutine goready(gp, 3) } } å°ç»“ä¸€ä¸‹channelçš„å…³é—­æµç¨‹ï¼š
å…³é—­ä¸€ä¸ªnil channel ä¼španic å…³é—­ä¸€ä¸ªå·²ç»å…³é—­çš„channelä¼španic æŠŠsendqå’Œrecvq é˜Ÿåˆ—ä¸­çš„å…ƒç´ åŠ å…¥åˆ° glistå½“ä¸­ï¼Œæ¸…é™¤æ‰€æœ‰sudogä¸Šæ‰€æœ‰æœªè¢«å¤„ç†çš„å…ƒç´  æœ€åæŠŠæ‰€æœ‰çš„é˜»å¡çš„sudogå…¨éƒ¨å”¤é†’ï¼Œåšä¸€äº›æ‰«å°¾å·¥ä½œ å‚è€ƒèµ„æ–™ ã€goè¯­è¨€çš„è®¾è®¡ä¸å®ç°ã€‘https://draveness.me/golang/ ã€GitBook ç å†œæ¡ƒèŠ±æºå¼€æºä¹¦ã€‘https://qcrao91.gitbook.io/go/</content></entry></search>